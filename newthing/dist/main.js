!function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);class o{constructor(t,e){this.x=t,this.y=e}toPolar(){return{magnitude:Math.hypot(this.x,this.y),angle:Math.atan2(this.y,this.x)}}get magnitude(){return this.toPolar().magnitude}get angle(){return this.toPolar().angle}static fromPolar(t,e){return new o(t*Math.cos(e),t*Math.sin(e))}normalize(){return this.times(1/this.magnitude)}plus(t){return new o(this.x+t.x,this.y+t.y)}minus(t){return new o(this.x-t.x,this.y-t.y)}times(t){return new o(this.x*t,this.y*t)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}rotate(t,e){let{magnitude:i,angle:n}=this.minus(e).toPolar();return n+=t,o.fromPolar(i,n).plus(e)}}class n{constructor(t,e,i,n,s){this.m=void 0===s?1:s,this.width=i,this.height=n,this.center=new o(t+i/2,e+n/2),this.v=new o(0,0),this.a=new o(0,0),this.theta=0,this.omega=0,this.alpha=0,this.J=this.m*(n*n+i*i)/12}get topLeft(){return this.center.plus(new o(-this.width,-this.height).times(.5)).rotate(this.theta,this.center)}get topRight(){return this.center.plus(new o(this.width,-this.height).times(.5)).rotate(this.theta,this.center)}get bottomLeft(){return this.center.plus(new o(-this.width,this.height).times(.5)).rotate(this.theta,this.center)}get bottomRight(){return this.center.plus(new o(this.width,this.height).times(.5)).rotate(this.theta,this.center)}move(t){this.center=this.center.plus(t)}rotate(t){this.theta+=t}intersects(t){let e=[this.topLeft.minus(this.topRight).normalize(),this.topRight.minus(this.bottomRight).normalize(),t.topLeft.minus(t.topRight).normalize(),t.topRight.minus(t.bottomRight).normalize()];e=e.map(t=>t.normalize().rotate(Math.PI/2,new o(0,0)));let i=[];for(let o=0;o<4;o++){let n=e[o],s=this,r=t;this.center.dot(n)>t.center.dot(n)&&(e[o]=n=n.times(-1));let h=[s.topLeft,s.topRight,s.bottomLeft,s.bottomRight].map(t=>t.dot(n)),a=[r.topLeft,r.topRight,r.bottomLeft,r.bottomRight].map(t=>t.dot(n));i[o]=Math.max(...h)-Math.min(...a)}return!!i.every(t=>t>=0)&&e[i.indexOf(Math.min(...i))]}}let s=document.getElementById("canvas"),r=50,h=40,a=1e3,l=5,u=50,m=.5,c=new n(3,0,2,1,150),g=new o(2,0),p=new n(4,4,2,1,150);function f(){return c.topLeft.plus(c.center.times(5)).plus(c.topRight).times(1/7)}function d(t){let e,i,o=s.getContext("2d");o.strokeStyle="black",o.beginPath(),({x:e,y:i}=t.topLeft),e*=u,i*=u,o.moveTo(e,i),({x:e,y:i}=t.topRight),e*=u,i*=u,o.lineTo(e,i),({x:e,y:i}=t.bottomRight),e*=u,i*=u,o.lineTo(e,i),({x:e,y:i}=t.bottomLeft),e*=u,i*=u,o.lineTo(e,i),o.closePath(),o.stroke(),o.strokeStyle="grey",o.beginPath(),({x:e,y:i}=f()),e*=u,i*=u,o.moveTo(e,i),({x:e,y:i}=g),e*=u,i*=u,o.lineTo(e,i),o.stroke()}function y(t){!function(){let t=new o(0,0),e=new o(0,l*c.m);t=t.plus(e);let i=g.minus(f()).toPolar();i=o.fromPolar(Math.max(i.magnitude-m,0),i.angle).times(a),t=(t=t.plus(i)).plus(c.v.times(-r)),c.a=t.times(1/c.m);let n=0;n+=i.cross(c.center.minus(f())),n+=c.omega*-h,c.alpha=n/c.J}(),c.v=c.v.plus(c.a.times(t)),c.omega+=c.alpha;let e=c.intersects(p);!1!==e&&(c.v=new o(c.v.cross(e),c.v.dot(e)).rotate(e.angle,new o(0,0)),console.log(c.v)),c.move(c.v.times(t)),c.rotate(c.omega*t),s.height=s.height,d(c),d(p)}p.rotate(1),setInterval(()=>y(.01),10),s.addEventListener("mousemove",()=>{g.x=event.offsetX/u,g.y=event.offsetY/u})}]);